1 REM MIRROR HORROR - KEYBOARD VERSION
4 REM DSICLAIMER - DONT REMOVE BORDER, OR THE GAME WILL CRASH THE PROGRAM
10 REM "MIRROR HORROR - KB""
20 POKE 53281,0:POKE 53280,0
30 POKE 646,5:PRINT CHR$(147):GOSUB 200
40 POKE 646,1
100 POKE 214,4:PRINT:POKE 211,3
110 PRINT "use mirror to kill monsters!"
111 POKE 214,6:PRINT:POKE 211,3
115 PRINT "use cursors to move over mirrorrs"
121 POKE 214,8:PRINT:POKE 211,3
125 PRINT "space-bar to tilt mirrors"
131 POKE 214,10:PRINT:POKE 211,3
135 PRINT "dont let monsters find you"
136 POKE 214,12:PRINT:POKE 211,3
138 PRINT "controls:"
139 POKE 214,13:PRINT:POKE 211,3
140 PRINT "[cursors][space bar][1][0]"
141 POKE 214,14:PRINT:POKE 211,3
142 PRINT "[return]"
196 GET KEYB$:REM WAIT FOR KEYPRESS
197 IF KEYB$="" THEN GOTO 196
198 POKE 646,1:PRINT CHR$(147):GOSUB 200:GOTO 300
199 :REM
200 FOR CNT=0 TO 19:REM "GAME FRAME"
201 POKE 1024+19-CNT+40*24,160
202 POKE 1024+19-CNT+40*0,160
203 POKE 1024+20+CNT+40*24,160
204 POKE 1024+20+CNT+40*0,160
206 POKE 1024+00+40*(12+INT(12/19*CNT)),160
207 POKE 1024+00+40*(12-INT(12/19*CNT)),160
208 POKE 1024+39+40*(12+INT(12/19*CNT)),160
209 POKE 1024+39+40*(12-INT(12/19*CNT)),160
210 NEXT:RETURN
300 :REM
301 DIM M(4):REM "MIRROR ANGLE"
302 M(1)=78:M(2)=67:M(3)=77:M(4)=66
303 G(1)=107:G(2)=113:G(3)=115:G(4)=114
400 :REM
401 FOR CNT=1 TO 10:REM "SET MIRRORS"
402 MX=INT(RND(1)*37)+1
403 MY=INT(RND(1)*22)+1
404 M=INT(RND(1)*4)+1
405 PK=PEEK(1024+MX+40*MY)
406 IF PK<> 32 THEN 402
407 POKE 1024+MX+40*MY,M(M):NEXT
410 :REM
411 FOR CNT=1 TO 10:REM "SET ENEMY"
412 EX=INT(RND(1)*37)+1
413 EY=INT(RND(1)*22)+1
414 PK=PEEK(1024+EX+40*EY)
415 IF PK<>32 THEN 412
416 POKE 1024+EX+40*EY,88
417 POKE 55296+EX+40*EY,2:NEXT
420 :REM
421 REM "SET GUN"
422 GX=INT(RND(1)*37)+1
423 GY=INT(RND(1)*22)+1
424 G=INT(RND(1)*4)+1
425 PK=PEEK(1024+GX+40*GY)
426 IF PK<>32 THEN 422
427 POKE 1024+GX+40*GY,G(G)
428 POKE 55296+GX+40*GY,6
500 :REM
501 REM "SET PLAYER"
502 PX=INT(RND(1)*37)+1
503 PY=INT(RND(1)*22)+1
504 PK=PEEK(1024+PX+40*PY)
505 IF PK<>32 THEN 502
600 :REM
601 PK=PEEK(1024+PX+40*PY)
602 POKE1024+PX+40*PY,81:REM RST STP
603 POKE1024+PX+40*PY,PK:DX=0:DY=0
604 GET KEYB$:IF KEYB$="" THEN 602
605 IF KEYB$=" " THEN GOSUB 700
606 IF KEYB$=CHR$(29) THEN DX=+1
607 IF KEYB$=CHR$(157)THEN DX=-1
608 IF KEYB$=CHR$(17) THEN DY=+1
609 IF KEYB$=CHR$(145)THEN DY=-1
610 IF KEYB$="1" OR KEYB$="0" THEN GOSUB800
611 IF KEYB$=CHR$(13) THEN GOSUB 900
617 S=PEEK(1024+PX+DX+40*(PY+DY))
618 IF S=160 THEN 602
619 IF S=88 THEN GOTO 2000
620 PX=PX+DX:PY=PY+DY:GOTO 601
699 :END
700 :REM
702 REM "ADJUST"
704 AD=PEEK(1024+PX+40*PY)
706 IF AD=M(1) THEN AD=M(2):GOTO 725
708 IF AD=M(2) THEN AD=M(3):GOTO 725
710 IF AD=M(3) THEN AD=M(4):GOTO 725
712 IF AD=M(4) THEN AD=M(1):GOTO 725
714 IF AD=G(1) THEN AD=G(2):GOTO 725
716 IF AD=G(2) THEN AD=G(3):GOTO 725
718 IF AD=G(3) THEN AD=G(4):GOTO 725
720 IF AD=G(4) THEN AD=G(1):GOTO 725
725 POKE 1024+PX+40*PY,AD:RETURN
800 :REM
801 IF KEYB$<>"0" THEN 810:PICK MIRR
802 FOR CNT=1 TO 4
804 PK=PEEK(1024+PX+40*PY)
806 IF PK<>M(CNT) THEN 809
808 POKE1024+PX+40*PY,32:MR=MR+1
809 NEXT
810 IF KEYB$<>"1" THEN 825:PLACE MIR
812 IF MR=0 THEN 825
814 PK=PEEK(1024+PX+40*PY)
816 IF PK<>32 THEN 825
818 M=INT(RND(1)*4)+1:MR=MR-1
820 POKE 1024+PX+40*PY,M(M)
825 RETURN
900 :REM
910 PK=PEEK(1024+GX+40*GY)
911 :REM
912 IF PK=107 THEN BX=+1:BY=0
914 IF PK=115 THEN BX=-1:BY=0
916 IF PK=114 THEN BX=0:BY=+1
918 IF PK=113 THEN BX=0:BY=-1
920 X=GX:Y=GY
921 PK=PEEK(1024+X+40*Y)
922 IF PK=32 THEN POKE 1024+X+40*Y,102
924 IF PK=88 THEN SC=SC+1000
925 IF PK=88 THEN POKE 1024+X+40*Y,86
926 X=X+BX:Y=Y+BY
928 PK=PEEK(1024+X+40*Y)
929 IF PK<>66 THEN 932
930 IF BX=+1 AND BY=0 THEN D=2
931 IF BX=-1 AND BY=0 THEN D=1
932 IF PK<>67 THEN 945
937 IF BX=0 AND BY=+1 THEN D=4
941 IF BX=0 AND BY=-1 THEN D=3
945 IF PK<>78 THEN 950
946 IF BX=+1 AND BY=0 THEN D=4:
947 IF BX=-1 AND BY=0 THEN D=3:
948 IF BX=0 AND BY=+1 THEN D=2:
949 IF BX=0 AND BY=-1 THEN D=1:
950 IF PK<>77 THEN 960
952 IF BX=+1 AND BY=0 THEN D=3
954 IF BX=-1 AND BY=0 THEN D=4
956 IF BX=0 AND BY=+1 THEN D=1
958 IF BX=0 AND BY=-1 THEN D=2
960 IF D=1 THEN BX=+1:BY=0
962 IF D=2 THEN BX=-1:BY=0
964 IF D=3 THEN BX=0:BY=+1
966 IF D=4 THEN BX=0:BY=-1
999 IF PK<>160 THEN 921
1000 PRINT CHR$(147):
1010 X=2:Y=2:X$=" good work":GOSUB 3000
1020 X=3:Y=4:X$="you killed":GOSUB 3000
1040 X$=STR$(SC/1000)+" enemies"
1050 X=4:Y=6:GOSUB 3000:X=5:Y=8
1060 X$="more plays?":GOSUB 3000
1070 GET KEYB$:IF KEYB$="" THEN 1070
1080 IF KEYB$="y" THEN RUN
1090 IF KEYB$="n" THEN END
1099 GOTO 1070
2000 :REM
2001 POKE 214,12:PRINT:POKE 211,13
2002 PRINT "{REVERSE ON}{SPACE*11}{REVERSE OFF}"
2004 POKE 214,13:PRINT:POKE 211,13
2006 PRINT "{REVERSE ON} GAME OVER {REVERSE OFF}"
2008 POKE 214,14:PRINT:POKE 211,13
2009 PRINT "{REVERSE ON}{SPACE*11}{REVERSE OFF}"
2010 FOR WT=0 TO 400:NEXT WT:
2011 PRINT CHR$(147);
2012 PRINT " lets try again "
2013 FOR WT=0 TO 400:NEXT WT:RUN
3000 POKE 214,Y:PRINT:POKE 211,X
3010 PRINT X$;:RETURN